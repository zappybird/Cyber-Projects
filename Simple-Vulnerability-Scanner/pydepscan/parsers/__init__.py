"""
parsers — Sub-package for dependency file parsers.

Each parser module exposes a single public function that accepts a file
path and returns a list of Dependency objects. This uniform interface
lets the scanner.py orchestrator treat all parsers the same way.

Parsers never make network calls — they only read local files.
"""

from __future__ import annotations

from dataclasses import dataclass, field
from typing import Optional


@dataclass
class Dependency:
    """
    A single parsed dependency with its version constraint.

    This is the common data structure that all parsers produce and that
    the scanner and API clients consume.

    Attributes:
        name:        The package name, normalised (lowercase, hyphens).
        specifier:   The version specifier string (e.g. ">=2.0,<3.0").
                     Empty string means no constraint was specified.
        extras:      Any PEP 508 extras (e.g. ["security"] for requests[security]).
        source_file: Which file this dependency came from (for reporting).
        line_number: Line in the source file (useful for in-place updates).
        raw_line:    The original unparsed line (preserved for file updates).
        comment:     Any inline comment on the line (e.g. "# pinned for CI").
    """
    name: str
    specifier: str = ""
    extras: list[str] = field(default_factory=list)
    source_file: Optional[str] = None
    line_number: Optional[int] = None
    raw_line: Optional[str] = None
    comment: Optional[str] = None